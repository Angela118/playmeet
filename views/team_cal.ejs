<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>경기 스케줄</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/team_schedule.css" rel="stylesheet">
    <link href="../css/calendar.css" rel="stylesheet">
    <link href="../css/common.css" rel="stylesheet">
    <link href="../css/FRAME.css" rel="stylesheet">

    <!-- Bootstrap core JavaScript -->
    <script src="../js/jquery.js"></script>
    <script src="../js/bootstrap.bundle.min.js"></script>

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <!--<script src="http://code.jquery.com/jquery-latest.js"></script>-->
	
	
	
	
	<!-- 달력-->	
	<style type="text/css">
		body {
			margin :40px 10px;
			padding : 0;
			font-family : "Lucida Grande", Helvetica, Arial, Verdana,sans-serif;
			font-size : 14px;
		}
		#calendar {
			max-width : 900px;
			margin : 0 auto;
		}
	</style>
	<link href="../css/fullcalendar.css" rel="stylesheet"/>
	<link href="../css/fullcalendar.print.css" rel="stylesheet" media="print"/>
	<script type="text/javascript" src="../js/moment.min.js"></script>
	<script type="text/javascript" src="../js/jquery.min.js"></script>
	<script type="text/javascript" src="../js/fullcalendar.js"></script>

</head>
<body class="whiteB">

<!--메뉴 영역 시작 : 나중에 파일로 따로 빼기 -->
<!--여기선 메뉴명 경기 스케줄로 되어 있음-->

<nav class="navbar blueB">

    <div class="top">
        <img src="../img/menu3.png" width="30rem" height="30rem" class="navbar-toggler" data-toggle="collapse" data-target="#navbarsExample01" aria-controls="navbarsExample01" aria-expanded="false" aria-label="Toggle navigation">

        <p class="logo">경기 스케줄</p>

        <a href="/chatroom"><img src="../img/envelope.png" class="menu_img" width="30rem" height="30rem" ></a>
    </div>

    <div class="collapse navbar-collapse" id="navbarsExample01">
        <div class="mypage">
            <img src="../profile_img/<%= profile_img %>" id="profile_pic" style="margin-right: .2rem; width:3rem; height: 3rem">
            <span id="name" style="font-weight: bold; font-size: 1.2rem; margin-left: .5rem"><%= teamname %> 팀</span>
            <a href="/teamprofile"><button class="btn btn-sm btn-warning" type="submit" style="margin-right: .5rem">내 정보</button></a>
            <a href="/uploadimg"><button class="btn btn-sm btn-warning" type="submit" style="margin-right: .5rem">프로필 사진 변경</button></a>
            <a href="/logout"><button class="btn btn-sm btn-warning" type="submit">로그아웃</button></a>
        </div>


        <ul class="navbar-nav mr-auto">
            <li class="nav-item">
                <a class="nav-link" href="/">홈 (매칭 팀 검색)<span class="sr-only">(current)</span></a>
            </li>
            <li class="nav-item" style="display:flex; align-items:center">
                <span style="margin-bottom: 0; padding: .5rem 0rem; color:white">우리 팀</span>
                <!--<hr align="right" style="border: solid 0.1rem white; width: 70%;">-->
            </li>

            <li class="nav-item">
                <a class="nav-link" href="/teamreceivedreview" style="margin-left:2rem">우리 팀 평가 점수</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/teamschedule" style="margin-left:2rem">경기 스케줄</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/matchapplication">매칭 등록</a>
            </li>

            <li class="nav-item">
                <a class="nav-link" href="/contact">개발자에게 연락</a>
            </li>
        </ul>
    </div>
</nav>

<div class="py-4 text-center"></div>

<!--메뉴 영역 끝 : 나중에 파일로 따로 빼기 -->

<div class="container">
    <div class="reco">

        <!--달력-->
		<script type="text/javascript">
			
			$(function(){

				var today = new Date();
				var dd = today.getDate();
				var mm = today.getMonth()+1; //January is 0!
				var yyyy = today.getFullYear();

				if(dd<10) {
					dd='0'+dd;
				}

				if(mm<10) {
					mm='0'+mm;
				}
				document.getElementById('calMonth').value = mm;

				var pevent = '<%= pEvent %>';
				var encoded = JSON.stringify(pevent).replace(/&#34;/g, "");
				encoded = encoded.replace(/&#39;/g, "'");
				var eventP = JSON.parse(encoded);
				
				var ff = '<%= ff %>';
				if(ff != 0){
				   mm = calMonth;
				}

				var ww,view;
				jQuery("#calendar").fullCalendar({
					  defaultDate : yyyy+"-"+mm+"-"+dd
					, defaultView : 'month'
					, editable : false
					, eventLimit : false
					, events: eval(eventP)
					, eventClick:function(event) {
						if(event) {
							alert("상대팀 : "+event.title + "\n" + "경기 장소 : " +event.description, "wicked", "width=700,height=600");
							return false;
						}
					}
					, windowResize: function(view) {
							ww = getWindowWidth();
							view = getView();
							var currentView = $('#calendar').fullCalendar('getView');
							if(view != currentView){
								$('#calendar').fullCalendar('changeView',view);
							}
							if(ww <= 768){
								$('.fc-header-right .fc-button').hide();
							}else{
								$('.fc-header-right .fc-button').show();
							}
					}
				});
				
				
				// 왼쪽 버튼을 클릭하였을 경우
				jQuery("button.fc-prev-button").click(function() {
					var date = jQuery("#calendar").fullCalendar("getDate");
					convertDate(date);
				});

				// 오른쪽 버튼을 클릭하였을 경우
				jQuery("button.fc-next-button").click(function() {
					var date = jQuery("#calendar").fullCalendar("getDate");
					convertDate(date);
				});

			});
			
			// 받은 날짜값을 date 형태로 형변환 해주어야 한다.
			function convertDate(date) {
				var date = new Date(date);
				var calMonth = date.yyyymmdd();
				document.getElementById('calMonth').value = calMonth;
				ff++;
				gopage();
			}
			// 받은 날짜값을 YYYY-MM-DD 형태로 출력하기위한 함수.
			Date.prototype.yyyymmdd = function() {
			//	var yyyy = this.getFullYear().toString();
				var mm = (this.getMonth() + 1).toString();
			//	var dd = this.getDate().toString();
				return (mm[1] ? mm : "0" + mm[0])+"";
			}
			
			function gopage(){
				location.href="/teamcal";
			}
			
			function getWindowWidth(){
				return $(window).width();
			}
			function getView(){
				return (ww <= 768) ? 'basicDay' : 'month';
			}


		</script>
        <div class="calendar-wrapper">
            <div id="calendar"></div>
        </div>
        <!--달력 끝-->

        <div class="main">
			<form action="/teamcal" id="calform" method="post">
				<input type="" name="calMonth" id="calMonth" readonly/>월 일정
				<br>
				<button type="submit" id="openCal"> 보기 </button>
			</form>
			
            
        </div>

    </div>
</div>





</body>
</html>
